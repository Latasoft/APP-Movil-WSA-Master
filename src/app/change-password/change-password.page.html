<ion-header>
  <ion-toolbar>
    <ion-title>Cambiar contraseña</ion-title>
    <ion-buttons slot="end">
      <ion-back-button defaultHref="/login"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding login-content">
  <!-- Fondo con silueta -->
  <div class="hero-bg"></div>

  <!-- Card flotante -->
  <div class="login-card">
    <div class="login-icon">
      <img src="/assets/logoWSA.svg" alt="Logo WSA" />
    </div>

    <h2 class="login-header">Crea una nueva contraseña</h2>
    <p class="login-subtitle">Ingresa y confirma tu nueva contraseña para continuar</p>

    <form (ngSubmit)="cambiarPassword()">
      <ion-item class="input-item">
        <ion-label position="floating">Nueva contraseña</ion-label>
        <ion-input
          type="password"
          [(ngModel)]="password"
          name="password"
          required>
        </ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label position="floating">Confirmar contraseña</ion-label>
        <ion-input
          type="password"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          required>
        </ion-input>
      </ion-item>

      <ion-text color="danger" *ngIf="password !== confirmPassword && confirmPassword">
        <p class="validation-text">Las contraseñas no coinciden</p>
      </ion-text>

      <ion-button expand="block" class="btn-primary" type="submit" [disabled]="!password || !confirmPassword || password !== confirmPassword || loading">
        Guardar nueva contraseña
      </ion-button>
    </form>

    <!-- Mensajes de estado -->
    <ion-text color="success" *ngIf="mensaje && !loading">
      <p class="success-text">{{ mensaje }}</p>
    </ion-text>

    <ion-text color="danger" *ngIf="error && !loading">
      <p class="error-text">{{ error }}</p>
    </ion-text>
  </div>

  <!-- Spinner de carga -->
  <ion-loading
    [isOpen]="loading"
    message="Actualizando contraseña..."
    spinner="crescent"
    backdropDismiss="false">
  </ion-loading>
</ion-content>
